---
title: Upravljanje dovoljenj v SharePointu, ki temelji na metapodatkih
slug: sl-upravljanje-dovoljenj-v-sharepointu-ki-temelji-na-metapodatkih
lang: sl
status: publish
excerpt: >-
  Tehniƒçni vodnik za konfiguracijo dinamiƒçne varnosti v SharePoint Online z izkori≈°ƒçanjem metapodatkov in tokov Power
  Automate.
description: >-
  Kako avtomatizirati upravljanje dovoljenj v SharePointu na podlagi metapodatkov dokumentov ali elementov seznama.
  Tehniƒçni vodnik z zgledi Power Automate in PnP PowerShell.
date: 2025-10-14T00:00:00.000Z
categories:
  - office365-sharepoint
tags:
  - sharepoint
  - microsoft 365
  - sicurezza
  - powerautomate
  - metadati
ogImage: /posts/gestione-permessi-sharepoint-metadati/og.webp
image: /posts/gestione-permessi-sharepoint-metadati/card.webp
sourceFile: insights/gestione-permessi-sharepoint-basati-sui-metadati.mdx
sourceSlug: gestione-permessi-sharepoint-basati-sui-metadati
sourceLang: it
---

# Upravljanje dovoljenj v SharePointu, temeljeƒçem na metapodatkih

## Uvod

V mnogih poslovnih scenarijih varnosti vsebine v **SharePoint Online** ni mogoƒçe upravljati le na ravni spletnega mesta ali knji≈ænice dokumentov. Nekateri dokumenti ali elementi seznama zahtevajo razliƒçen nivo za≈°ƒçite ‚Äî na primer glede na **poslovno enoto**, **vrsto dokumenta** ali **nivo zaupnosti**.

V teh primerih je mogoƒçe implementirati **dinamiƒçno upravljanje dovoljenj** na podlagi **metapodatkov**. SharePoint namreƒç omogoƒça uporabo prilagojenih stolpcev (site columns ali content type fields) kot logiƒçni spro≈æilec za samodejno spremembo dovoljenj datoteke ali elementa.

Ta ƒçlanek prikazuje tehniƒçni pristop, ki temelji na:

* **Metapodatki** za kategorizacijo dokumentov.
* **Power Automate** tokovi za dinamiƒçno odstranjevanje in dodeljevanje dovoljenj.
* **PnP PowerShell** in REST API za napredne avtomatizacije.

Please provide the text you would like to have translated to Slovenian.

## 1. Logiƒçna arhitektura

Osnovno naƒçelo je preprosto: vsakiƒç, ko je datoteka ustvarjena ali spremenjena, SharePoint preveri vrednost enega ali veƒç metapodatkov in posodobi dovoljenja elementa na podlagi vnaprej doloƒçenih pravil.

**Praktiƒçen primer**:
ƒåe je metapodatka `Dipartimento` = *Finanza*, potem bo element dostopen samo skupini *Finanza_Viewers*.

### Vkljuƒçene komponente

1. **Knji≈ænica dokumentov** s prilagojenimi stolpci (npr. `Zaupnost`, `Oddelek`, `Projekt`).
2. **Power Automate tok** s spro≈æilcem *Ko je datoteka ustvarjena ali spremenjena (samo lastnosti)*.
3. **HTTP REST SharePoint klici** ali **posebne Power Automate akcije** za upravljanje dovoljenj.

Please provide the text you would like to have translated into Slovenian.

## 2. Konfiguracija knji≈ænice

Ustvari **document library** ali **prilagojeno listo** z naslednjimi stolpci:

| Ime stolpca    | Tip     | Primer vrednosti               | Uporaba                     |
| -------------- | ------- | ------------------------------ | --------------------------- |
| `Zaupnost`     | Izbira  | Javno / Interno / Zaupno      | Doloƒça raven dostopa       |
| `Oddelek`      | Izbira  | HR / IT / Finance / Pravno     | Dodeli poobla≈°ƒçeno skupino  |
| `Odgovorna oseba` | Oseba | Ime uporabnika M365            | Dodeli specifiƒçno dovoljenje |

Te stolpci bodo postali **kljuƒçni metapodatki** za logiko varnosti.

I'm sorry, but it seems that the text you wanted to translate is missing. Could you please provide the text you would like to have translated into Slovenian?

## 3. Power Automate: avtomatsko upravljanje dovoljenj

Najuƒçinkovitej≈°i naƒçin za upravljanje dinamiƒçne varnosti je uporaba **flusa Power Automate**.

### a) Trigger

Uporabi povezovalnik:

> **Ko je datoteka ustvarjena ali spremenjena (samo lastnosti)**

Dodajte **pogoj** za preverjanje, ali so bili kljuƒçni metapodatki (`Dipartimento`, `Riservatezza`) spremenjeni.

### b) Odstranitev dedovanih dovoljenj

Da bi se izognili konfliktom, morate prekiniti dedovanje dovoljenj z akcijo HTTP REST:

```http
POST https://{tenant}.sharepoint.com/sites/{site}/_api/web/lists/getbytitle('Documenti')/items(@{triggerOutputs()?['body/ID']})/breakroleinheritance(copyRoleAssignments=false, clearSubscopes=true)
```



### c) Dodeljevanje novih dovoljenj

Po pretrganju dedovanja dodelite dovoljenja na podlagi vrednosti metapodatkov:

```http
POST https://{tenant}.sharepoint.com/sites/{site}/_api/web/lists/getbytitle('Documenti')/items(@{triggerOutputs()?['body/ID']})/roleassignments/addroleassignment(principalid=@{variables('GroupID')}, roledefid=1073741826)
```



> Dove `roledefid` predstavlja raven dovoljenja (1073741826 = Contribute, 1073741827 = Read, itd.).

Lahko mapirate vrednosti metapodatkov na M365 skupine preko **konfiguracijske tabele** ali **SharePoint seznama** za podporo.

Please provide the text you would like to have translated to Slovenian.

## 4. Primer: dinamiƒçna dovoljenja za oddelek

### Obiettivo

Vsak dokument, nalo≈æen v knji≈ænico, mora biti dostopen samo skupini, ki ustreza oddelku, izbranemu v metapodatku `Dipartimento`.

### Re≈°itev

1. Stolpec `Dipartimento` z vrednostmi: *IT, HR, Finance, Legal*.
2. Seznam `AccessControl` z mapiranjem:

| Oddelek      | Skupina         | ID |
   | ------------ | --------------- | -- |
   | IT           | IT_Viewers      | 14 |
   | HR           | HR_Viewers      | 22 |
   | Finance      | Finance_Viewers | 28 |
   | Legal        | Legal_Viewers   | 33 |
3. Power Automate tok, ki:

* Nastavi vrednost `Dipartimento`.
   * Poi≈°ƒçi ID skupine na seznamu `AccessControl`.
   * Odstrani dedovane pravice.
   * Dodeli pravico samo za branje ustrezni skupini.

I'm sorry, but it seems that the text you want to translate is missing. Could you please provide the text you'd like translated to Slovenian?

## 5. Napredno upravljanje z PnP PowerShell

Za kompleksne ali obse≈æne implementacije lahko uporabi≈° **PnP PowerShell**.

### Primer skripta

```powershell
Connect-PnPOnline -Url "https://tenant.sharepoint.com/sites/Sicurezza" -Interactive

$items = Get-PnPListItem -List "Documenti Riservati"

foreach ($item in $items) {
    $dip = $item["Dipartimento"]
    $group = Get-PnPGroup -Identity "$dip-Viewers"
    Set-PnPListItemPermission -List "Documenti Riservati" -Identity $item.Id -AddRole "Read" -Group $group.Title -BreakRoleInheritance
}
```



Ta pristop je idealen za:

* Masovni posodobitve.
* Periodiƒçne sinhronizacije iz zunanjih sistemov.
* Naƒçrtovane avtomatizacije preko Azure Automation.

I'm sorry, but it seems that the text you want to translate is missing. Could you please provide the text you would like to have translated into Slovenian?

## 6. Varnostne in zmogljivostne razmisleke

* **Izogibajte se prevelikemu ≈°tevilu elementov s posebnimi dovoljenji** ‚Üí SharePoint ima omejitve (~50.000 edinstvenih elementov na seznam).
* **Centralizirajte pravila** v konfiguracijski seznam, tako da lahko spremenite kriterije brez ponovnega pisanja tokov.
* **Revizija in bele≈æenje**: vedno shranite dnevnik sprememb dovoljenj iz razlogov skladnosti.
* **Uporabite Site Scripts ali PowerShell** za kloniranje konfiguracij med okolji (UAT ‚Üí Prod).

I'm sorry, but it seems that the text you want to translate is missing. Could you please provide the text that you would like to have translated into Slovenian?

## 7. Zakljuƒçek

Upravljanje dovoljenji v SharePointu na podlagi **metapodatkov** omogoƒça dosego idealne ravnote≈æja med **fleksibilnostjo** in **varnostjo**. 
S kombiniranjem **Power Automate**, **REST API** in **PnP PowerShell** lahko ustvarite prilagodljiv in raz≈°irljiv varnostni sistem, ki se dinamiƒçno prilagaja organizacijskim spremembam.

üëâ ≈Ωeli≈° implementirati dinamiƒçno varnost, ki temelji na metapodatkih, v svojem okolju Microsoft 365? [Kontaktiraj me](/contact) za prilagojeno svetovanje ali odkrij druge re≈°itve v razdelku [Office365 & SharePoint](/insights/office365-sharepoint).