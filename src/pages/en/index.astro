---
import UnifiedLayout from '../../layouts/UnifiedLayout.astro'
import Hero from '../../components/Home/Hero.astro'
import About from '../../components/Home/About.astro'
import Services from '../../components/Home/Services.astro'
import Expertise from '../../components/Home/Expertise.astro'
import CaseStudies from '../../components/Home/CaseStudies.astro'
import LatestInsights from '../../components/Home/LatestInsights.astro'
import Testimonials from '../../components/Home/Testimonials.astro'
import Contact from '../../components/Home/Contact.astro'
import { getCollection } from 'astro:content'
import en from '../../i18n/en.json'

// Dati per la pillar page - contenuti inglesi
const latestInsights = await getCollection('insights', ({ id }) => 
  id.startsWith('en-')
)
const recentInsights = latestInsights
  .filter(post => post.data.status === 'publish')
  .sort((a, b) => new Date(b.data.date || 0).getTime() - new Date(a.data.date || 0).getTime())
  .slice(0, 3)

const featuredCaseStudies = await getCollection('caseStudies', ({ id }) => 
  id.startsWith('en-')
)
const recentCaseStudies = featuredCaseStudies
  .sort((a, b) => new Date(b.data.date || 0).getTime() - new Date(a.data.date || 0).getTime())
  .slice(0, 3)
---

<UnifiedLayout enableTransitions={true} title={en.pages.home.title} description={en.pages.home.description}>
  <Hero eyebrow={en.pages.home.hero.eyebrow} title={en.pages.home.hero.title} subtitle={en.pages.home.hero.subtitle} primary={{ href: '/en/services/', label: en.pages.home.hero.primaryLabel }} secondary={{ href: '/en/case-studies/', label: en.pages.home.hero.secondaryLabel }} />
  <About 
    title={en.pages.home.about.title}
    lead={en.pages.home.about.lead}
    paragraph={en.pages.home.about.paragraph}
    tags={en.pages.home.about.tags}
    linkHref={en.pages.home.about.linkHref}
    linkText={en.pages.home.about.linkText}
    photoLabel={en.pages.home.about.photoLabel}
    photoName={en.pages.home.about.photoName}
    yearsBadgeValue={en.pages.home.about.yearsBadgeValue}
    yearsBadgeSubtitle={en.pages.home.about.yearsBadgeSubtitle}
    imageSrc={en.pages.home.about.imageSrc}
    imageAlt={en.pages.home.about.imageAlt}
    imageAspectClass={en.pages.home.about.imageAspectClass}
  />
  <Services 
    title={en.pages.home.services.title}
    subtitle={en.pages.home.services.subtitle}
    servicesLinkBase={en.pages.home.services.servicesLinkBase}
    bottomCtaText={en.pages.home.services.bottomCtaText}
    bottomCtaHref={en.pages.home.services.bottomCtaHref}
    services={en.pages.home.services.items}
  />
  <Expertise 
    title={en.pages.home.expertise.title}
    subtitle={en.pages.home.expertise.subtitle}
    ctaText={en.pages.home.expertise.ctaText}
    ctaHref={en.pages.home.expertise.ctaHref}
    areas={en.pages.home.expertise.areas}
  />
  <CaseStudies 
    items={recentCaseStudies} 
    baseUrl="/en/case-studies" 
    title={en.pages.home.caseStudies.title} 
    subtitle={en.pages.home.caseStudies.subtitle}
    allProjectsLabel={en.pages.home.caseStudies.allProjectsLabel}
  />
  <LatestInsights 
    items={recentInsights} 
    baseUrl="/en/insights" 
    title={en.pages.home.latestInsights.title} 
    subtitle={en.pages.home.latestInsights.subtitle}
    allArticlesLabel={en.pages.home.latestInsights.allArticlesLabel}
    locale={en.pages.home.latestInsights.locale}
  />
  <Testimonials 
    title={en.pages.home.testimonials.title}
    items={en.pages.home.testimonials.items}
  />
  <Contact />
</DefaultLayout>
