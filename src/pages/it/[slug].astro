---
import UnifiedLayout from '../../layouts/UnifiedLayout.astro'
import { getCollection, getEntry, render } from 'astro:content'

export async function getStaticPaths() {
  const collection = await getCollection('pages', ({ id }) => {
    // Solo contenuti IT: nessun prefisso en-/sl-
    return !id.startsWith('en-') && !id.startsWith('sl-')
  })
  return collection
    .filter((e) => (e.data?.status ?? 'publish') === 'publish')
    .map((e) => {
      const full = e.slug ?? e.id.replace(/\.mdx?$/, '')
      return { params: { slug: full } }
    })
}

const { slug } = Astro.params
const entry = await getEntry('pages', slug)
if (!entry) throw new Error('Not found')
const { Content } = await render(entry)
---
<UnifiedLayout enableTransitions={true} title={entry.data.title} description={entry.data.excerpt}>
  <article class="container my-16 prose">
    <h1>{entry.data.title}</h1>
    <div class="content-large">
      <Content />
    </div>
  </article>
</UnifiedLayout>
