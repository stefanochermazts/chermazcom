---
interface Props {
  action?: string
  privacy?: string
  title?: string
  nameLabel?: string
  emailLabel?: string
  messageLabel?: string
  privacyText?: string
  privacyLink?: string
  submitText?: string
  lang?: string
}

const { 
  action = '/success', 
  privacy = 'I tuoi dati saranno trattati secondo la nostra Privacy Policy.',
  title = 'Contatti',
  nameLabel = 'Nome',
  emailLabel = 'Email',
  messageLabel = 'Messaggio',
  privacyText = 'Ho letto e accetto la',
  privacyLink = '/it/privacy',
  submitText = 'Invia',
  lang = 'it'
} = Astro.props

// Determina il template email in base alla lingua
const emailTemplate = {
  'it': 'grazie-contatto-it',
  'en': 'thank-you-contact-en', 
  'sl': 'hvala-kontakt-sl'
}[lang] || 'grazie-contatto-it'

// Oggetto email personalizzato per lingua
const emailSubject = {
  'it': 'Grazie per aver contattato Stefano Chermaz',
  'en': 'Thank you for contacting Stefano Chermaz',
  'sl': 'Hvala, ker ste se obrnili na Stefana Chermaza'
}[lang] || 'Grazie per aver contattato Stefano Chermaz'
---

<section class="pt-16 sm:pt-20">
  <div class="mx-auto max-w-2xl px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl font-bold tracking-tight text-zinc-900 dark:text-zinc-50 sm:text-4xl">{title}</h2>
    <form data-contact class="mt-8 grid gap-4" method="post" action={action} name="contact" data-netlify="true" netlify-honeypot="bot-field">
      <input type="hidden" name="form-name" value="contact" />
      <input type="hidden" name="_template" value={emailTemplate} />
      <input type="hidden" name="_subject" value={emailSubject} />
      <input type="hidden" name="_to" value="stefano@chermaz.com" />
      <input type="hidden" name="_replyto" value="stefano@chermaz.com" />
      <input type="hidden" name="_from" value="noreply@chermaz.com" />
      <p class="hidden">
        <label>Don't fill this out: <input name="bot-field" /></label>
      </p>
      <label class="block">
        <span class="block text-sm font-medium text-zinc-900 dark:text-zinc-50">{nameLabel}</span>
        <input name="name" required class="mt-1 w-full rounded-lg ring-1 ring-zinc-300 dark:ring-zinc-600 dark:bg-zinc-800 dark:text-zinc-100 px-3 py-2 focus:outline-2 focus:outline-offset-2 focus:outline-brand-500" />
      </label>
      <label class="block">
        <span class="block text-sm font-medium text-zinc-900 dark:text-zinc-50">{emailLabel}</span>
        <input type="email" name="email" required class="mt-1 w-full rounded-lg ring-1 ring-zinc-300 dark:ring-zinc-600 dark:bg-zinc-800 dark:text-zinc-100 px-3 py-2 focus:outline-2 focus:outline-offset-2 focus:outline-brand-500" />
      </label>
      <label class="block">
        <span class="block text-sm font-medium text-zinc-900 dark:text-zinc-50">{messageLabel}</span>
        <textarea name="message" rows="5" required class="mt-1 w-full rounded-lg ring-1 ring-zinc-300 dark:ring-zinc-600 dark:bg-zinc-800 dark:text-zinc-100 px-3 py-2 focus:outline-2 focus:outline-offset-2 focus:outline-brand-500"></textarea>
      </label>
      <label class="flex items-start gap-2">
        <input type="checkbox" name="privacyConsent" value="true" required class="mt-1" />
        <span class="text-sm text-zinc-700 dark:text-zinc-300">{privacyText} <a href={privacyLink} class="underline">Privacy Policy</a></span>
      </label>
      <p class="text-sm text-zinc-700 dark:text-zinc-300">{privacy}</p>
      <div>
        <button type="submit" class="btn btn-primary">{submitText}</button>
      </div>
    </form>
  </div>
</section>

<style>
  /* Stile locale e isolato per il pulsante submit del form contatti */
  form[data-contact] button[type='submit'] {
    background-color: var(--brand-secondary, #1f2f63);
    color: #fff;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 600;
  }

  form[data-contact] button[type='submit']:hover {
    background-color: var(--brand-primary, #263f78);
  }
</style>


